Скрипт для автоматической установки Windows Updates на вирт.машинах.
Исполняемым скриптом является updater.ps1 , для его работы необходимы 2 файла : Get-WindowsUpdates.ps1(скрипт обновления на машине) и VMWareModule.ps1(вспомогательные функции).
Прежде чем запустить скрипт, нужно поправить параметры, отмеченные как "Edit before run" - эти параметры определяют:
	1. вцентр, хост и стенд на котором нужно произвести обновление
	2. снапшот , с которого будет производиться обновление(рекомендуется использовать последний снапшот на машинах)
	3. список машин
По необходимости в файле Get-WindowsUpdates.ps1 можно изменить категорию апдейтов для установки :
	Для этого нужно в строке $SearchResult = $UpdateSearcher.Search("IsInstalled=0 and Type='Software' and IsHidden=0 and CategoryIDs contains  'E6CF1350-C01B-414D-A61F-263D14D133B4'")
	поменять параметры на необходимые.
	Список всех GUID'ов тут : https://msdn.microsoft.com/en-us/library/ff357803(v=vs.85).aspx

Рекомендуется использовать папку C:\updater , чтобы не править этот путь в скрипте.
Также можно использовать скрипт для вывода доступных апдейтов : для этого нужно в файле Get-WindowsUpdates.ps1 параметр Install  задать как false.
Для работы скрипта на машине следует задать ExecutionPolicy  в состояние Unrestricted.

СКРИПТ УМЕЕТ :
Выбирать из всех доступных апдейтов нужные по заданному фильтру
Устанавливать их удаленно на каждой машине из списка
Автоматически принимать Eula при установке 
Проверять что установленые апдейты требуют перезагрузки и писать об этом в лог.
Проверять состояние сервиса WindowsUpdates и приводить его после работы в первоначальное состояние.

СКРИПТ НЕ УМЕЕТ :
Устанавливать апдейты требующие пользовательского ввода, такие апдейты пропускаются.
Корректно обрабатывать ситуацию, когда требуется несколько ребутов для установки всех апдейтов.
Устанавливать апдейты по заранее заданному списку.
Обрабатывать различные ошибки в ходе установки.